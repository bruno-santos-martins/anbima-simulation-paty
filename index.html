<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="theme-color" content="#0b0d12" />
<meta name="description" content="Simulado CEA/ANBIMA - Certifica√ß√£o de Especialista em Investimentos" />
<meta name="author" content="Simulado CEA" />
<title>üìö Simulado CEA/ANBIMA - Mobile</title>
<style>
  :root {
    --bg: #0b0d12;
    --card: #121623;
    --muted: #9aa3b2;
    --text: #e7ecf3;
    --brand: #4da3ff;
    --ok: #21c07a;
    --warn: #ffcc00;
    --bad: #ff6464;
    --chip: #1b2234;
  }
  html,body { margin:0; background:var(--bg); color:var(--text); font:16px/1.45 Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; }
  .wrap { max-width: 1080px; margin: 16px auto; padding: 0 16px; }
  h1 { font-size: 24px; margin: 0 0 8px; text-align: center; }
  .sub { color: var(--muted); margin-bottom: 20px; text-align: center; }
  .toolbar { display:flex; flex-wrap:wrap; gap:12px; margin:20px 0 24px; justify-content: center; }
  button, .btn {
    background: #1a2233; color: var(--text); border: 1px solid #2a3550; border-radius: 12px; padding: 12px 16px; cursor: pointer;
    font-size: 14px; min-height: 44px; touch-action: manipulation;
  }
  button:active { background:#212b41; transform: scale(0.98); }
  .btn-primary { background: var(--brand); border-color: #338fff; color:#031324; font-weight:600; }
  .btn-primary:active { filter: brightness(1.1); }
  .btn-ghost { background: transparent; border-color:#2a3550; }
  .grid { display: grid; gap: 16px; margin-bottom: 60px; }
  .q-card {
    background: var(--card); border: 1px solid #1c2336; border-radius: 16px; padding: 20px; position: relative;
  }
  .q-head { display:flex; justify-content: space-between; align-items: start; gap: 12px; margin-bottom: 12px; }
  .q-title { font-weight: 600; }
  .q-id { color: var(--muted); font-weight: 600; font-size: 14px; }
  .q-body { margin: 0 0 16px; white-space: pre-wrap; line-height: 1.5; }
  .opts { display:grid; gap: 12px; margin: 16px 0; }
  .opt {
    display:flex; gap:12px; align-items:flex-start; padding: 16px; border: 2px solid #223052; border-radius: 12px; background:#111727;
    min-height: 56px; cursor: pointer; transition: all 0.2s ease;
  }
  .opt:active { transform: scale(0.98); background: #1a1f3a; }
  .opt input { margin-top:2px; width: 20px; height: 20px; }
  .opt label { cursor: pointer; flex:1; line-height: 1.4; }
  .meta { display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin-top:16px; }
  .chip { background: var(--chip); border: 1px solid #243152; border-radius: 999px; padding: 8px 12px; color: var(--muted); font-size: 12px;}
  .star { color: var(--warn); margin-left: 8px; font-size: 18px; }
  .correct { border-color: #2a6d4b !important; background: #0e1820 !important; }
  .wrong { border-color: #5c2a2a !important; background: #201112 !important; }
  .explain { margin-top: 12px; color: var(--muted); font-size: 14px; line-height: 1.4; padding: 12px; background: rgba(0,0,0,0.2); border-radius: 8px; }
  .footer { display:flex; gap: 8px; flex-wrap: wrap; align-items:center; margin-top: 8px; }
  .score-box { background:#0e1820; border:1px solid #1d3a2e; padding:10px 12px; border-radius:10px; }
  details > summary { cursor: pointer; color: var(--muted); }
  .sr { position:absolute; width:1px; height:1px; clip:rect(0 0 0 0); overflow:hidden; white-space:nowrap; }
  .note { color: var(--muted); font-size: 12px; }
  .small { font-size:12px; color: var(--muted); }
  .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background:#0e1524; padding: 2px 6px; border: 1px solid #223052; border-radius: 6px;}
  .danger { color: var(--bad); }
</style>
</head>
<body>
<div class="wrap">
  <h1>üìö Simulado CEA/ANBIMA</h1>
  <div class="sub">
    Simulado completo com <strong>gabarito</strong> e <strong>coment√°rios especializados</strong> para certifica√ß√£o CEA.
  </div>

  <div class="toolbar">
    <button class="btn-primary" id="submitBtn">‚úÖ Corrigir</button>
    <button class="btn" id="resetBtn">üîÑ Limpar respostas</button>
    <button class="btn" id="toggleKey">üëÅÔ∏è Mostrar respostas corretas</button>
    <button class="btn" id="exportKey">üì§ Exportar gabarito</button>
    <label class="btn-ghost" for="importKeyInput">üì• Importar gabarito</label>
    <input id="importKeyInput" type="file" accept="application/json" class="sr" />
    <span class="chip" id="statChip">0 respondidas</span>
    <span class="chip" id="scoreChip">Sem corre√ß√£o</span>
  </div>

  <div id="questions" class="grid"></div>

  <details style="margin-top:18px;">
    <summary>Ajuda r√°pida</summary>
    <ul>
      <li><span class="kbd">Mostrar respostas corretas</span> &rarr; alterna a visualiza√ß√£o da alternativa correta (‚òÖ) e exibe o coment√°rio do especialista.</li>
      <li><span class="kbd">Corrigir</span> &rarr; calcula sua pontua√ß√£o e destaca acertos/erros (e mostra coment√°rios).</li>
      <li>Progresso e gabarito ficam salvos no navegador (localStorage).</li>
      <li>Voc√™ pode <strong>Exportar/Importar</strong> um arquivo JSON com o gabarito e suas respostas.</li>
    </ul>
  </details>

  <p class="note" style="margin-top:16px">
    Caso alguma alternativa do seu PDF (marcada em amarelo) seja diferente, me diga quais n√∫meros/letras que eu ajusto aqui.
  </p>

</div>

<script>

  const QUESTIONS = [
  {
    id: 1,
    text: `O saldo l√≠quido da Renda Prim√°ria no Balan√ßo de Pagamentos representa
a:`,
    options: [
      `A. remunera√ß√£o dos trabalhadores; renda dos investimentos diretos no pa√≠s;
renda dos investidores em carteira; e renda dos ativos de reserva.`,
      `B. renda obtida pelo capital de curto prazo em investimentos em carteira, renda
dos investimentos diretos no pa√≠s; renda dos ativos de reserva; e renda com
opera√ß√µes de derivativos.`,
      `C. remunera√ß√£o dos exportadores; renda dos investimentos realizados no pa√≠s;
renda dos investimentos em carteira; e renda dos ativos em reserva.`,
      `D. remunera√ß√£o dos exportadores de bens e servi√ßos; e importadores de bens e
servi√ßos.`
    ],
    correct: 0,
    explain: "Renda Prim√°ria = remunera√ß√£o do trabalho e do capital (IDP, carteira) + reservas; n√£o inclui bens/servi√ßos."
  },
  {
    id: 2,
    text: `Um investidor adquiriu, a pre√ßo de mercado, US Treasury Bonds
emitidos com cupom de 5,00% a.a. Na data de aquisi√ß√£o, o mercado
projetou uma taxa de juros de 4,00% a.a., para o mesmo per√≠odo do t√≠tulo.
Nesse caso, o t√≠tulo foi negociado:`,
    options: [
      "A. acima do valor ao par.",
      "B. abaixo do valor ao par.",
      "C. independentemente do valor ao par.",
      "D. ao par."
    ],
    correct: 0,
    explain: "Cupom (5%) > yield (4%) ‚áí pre√ßo com √°gio (acima do par)."
  },
  {
    id: 3,
    text: `Umas das poss√≠veis medidas a serem implementadas pelo Banco Central
do Brasil (BACEN) para reduzir a quantidade de dinheiro em circula√ß√£o na
economia e a exposi√ß√£o das institui√ß√µes financeiras ao risco de cr√©dito √©:`,
    options: [
      "A. a conten√ß√£o dos gastos p√∫blicos.",
      "B. a compra de t√≠tulos p√∫blicos no Open Market.",
      "C. o aumento dos dep√≥sitos compuls√≥rios.",
      "D. o aumento da al√≠quota do Imposto sobre Produtos Industrializados (IPI)."
    ],
    correct: 2,
    explain: "Elevar compuls√≥rio retira liquidez e reduz o multiplicador de cr√©dito."
  },
  {
    id: 4,
    text: `Um investidor, pessoa f√≠sica, residente e domiciliado no Brasil, estar√°
isento da cobran√ßa de Imposto de Renda nos rendimentos distribu√≠dos por
um Fundo de Investimento Imobili√°rio (FlI), caso:
I. as cotas sejam negociadas exclusivamente em mercados de bolsa ou
balc√£o organizado.
II. o FII possua, no m√≠nimo, 100 cotistas.
III. o cotista possua, no m√°ximo, 10% da totalidade das cotas.
Est√° correto o que se afirma em:`,
    options: [
      "A. II e III, apenas.",
      "B. I e Ill, apenas.",
      "C. I, II e III.",
      "D. l e lI, apenas."
    ],
    correct: 2,
    explain: "Isen√ß√£o (PF): negocia√ß√£o em mercado organizado + ‚â•100 cotistas + nenhum PF ‚â•10%."
  },
  {
    id: 5,
    text: `Um investidor de um fundo cambial reclama que n√£o obteve a totalidade
da expressiva desvaloriza√ß√£o ocorrida do real. O mesmo deve ser
informado de que, al√©m da taxa de administra√ß√£o,`,
    options: [
      "A. a eleva√ß√£o do cupom cambial poder√° provocar desvaloriza√ß√£o da cota.",
      "B. a exist√™ncia de fusos hor√°rios nos principais mercados financeiros inibe a\ncorreta precifica√ß√£o de ativos denominados em moeda estrangeira.",
      "C. a redu√ß√£o do cupom cambial poder√° ter impacto negativo no valor da cota.",
      "D. o spread existente entre as cota√ß√µes de compra e venda de moeda\nestrangeira reduz a rentabilidade do fundo."
    ],
    correct: 0,
    explain: "Cupom cambial mais alto tende a reduzir o valor da cota do fundo cambial."
  },
  {
    id: 6,
    text: `Um indiv√≠duo, 30 anos de idade, ingressou recentemente em uma
empresa que oferece a seus funcion√°rios um Fundo de Previd√™ncia
Complementar Multipatrocinado, que possui diversos perfis de carteira de
investimento. Para que o indiv√≠duo se aposente aos 55 anos, evite o risco
de d√©ficit t√©cnico e obtenha a menor al√≠quota de Imposto de Renda sobre a
reserva, ele deve aderir a um plano de:`,
    options: [
      "A. Benef√≠cio Definido e optar pelo regime de tributa√ß√£o exclusivo na fonte no\nresgate.",
      "B. Contribui√ß√£o Definida e optar pelo regime de tributa√ß√£o definitivo no resgate.",
      "C. Contribui√ß√£o Definida e optar pelo regime de tributa√ß√£o compens√°vel no\nresgate.",
      "D. Benef√≠cio Definido e optar pelo regime de tributa√ß√£o progressivo no resgate."
    ],
    correct: 1,
    explain: "Plano CD evita risco atuarial de d√©ficit do BD; tributa√ß√£o definitiva d√° previsibilidade."
  },
  {
    id: 7,
    text: `Com o objetivo de reduzir o risco de uma carteira de a√ß√µes um investidor
pretende aplicar 50% de seus recursos na a√ß√£o X e os 50% restantes nas
a√ß√µes Y ou Z. ... (dados e correla√ß√µes)
Nesse caso, ... recomendar√° ... X e a a√ß√£o`,
    options: [
      "A. Y, pois seu beta √© inferior ao de Z.",
      "B. Y ou Z, pois possuem o mesmo coeficiente alfa.",
      "C. Z, pois seu desvio padr√£o √© menor do que o de Y.",
      "D. Y, pois sua correla√ß√£o com X √© menor do que a correla√ß√£o de X com Z."
    ],
    correct: 3,
    explain: "Diversifica√ß√£o melhor com correla√ß√£o menor/negativa: œÅ(X,Y)=-0,40 < 0,90."
  },
  {
    id: 8,
    text: `Um analista avalia a a√ß√£o da empresa "Delta" ... (Rf=10% a.a.; Rm=15% a.a.; Œ≤=0,85)
Ent√£o, o retorno esperado, ao ano, ... (CAPM) √© de:`,
    options: ["A. 11,25%","B. 22,75%","C. 14,25%","D. 17,25%"],
    correct: 2,
    explain: "CAPM: 10% + 0,85√ó(15%-10%) = 14,25%."
  },
  {
    id: 9,
    text: `Um investidor qualificado ... quer otimizar impacto tribut√°rio.
Nesse caso ... recomendar:
I. deb√™ntures incentivadas.
II. CRI.
III. cotas de FIDC.
Est√° correto o que se afirma em`,
    options: ["A. I e Ill, apenas.","B. l e ll, apenas.","C. I, II e III.","D. Il e lIl, apenas."],
    correct: 2,
    explain: "Combina√ß√£o usual pr√≥-efici√™ncia tribut√°ria: deb√™nture incentivada (PF isenta), CRI, FIDC."
  },
  {
    id: 10,
    text: `De acordo com a Resolu√ß√£o CVM n¬∞ 30 ... suitability n√£o se aplica quando:
I. PF investidor qualificado (‚â•R$1 mi e declara√ß√£o).
II. PJ de direito p√∫blico.
III. Carteira administrada discricionariamente por gestor autorizado.
Est√° correto o que se afirma em:`,
    options: ["A. I, Il e III.","B. II e III, apenas.","C. l e Il, apenas.","D. I e III, apenas."],
    correct: 0,
    explain: "As tr√™s hip√≥teses dispensam verifica√ß√£o de adequa√ß√£o."
  },
  {
    id: 11,
    text: `M√¥nica decidiu contratar ... VGBL ... maior acumula√ß√£o em 30 anos e renda vital√≠cia.
Na fase de diferimento, ______ taxa de carregamento e ______ rentabilidade; na concess√£o, ______ revers√£o do excedente.`,
    options: [
      "A. menor ‚Äì maior - menor",
      "B. menor ‚Äì menor - menor",
      "C. menor ‚Äì maior - maior",
      "D. maior ‚Äì maior ‚Äì menor"
    ],
    correct: 2,
    explain: "Para acumular mais: menor carregamento, maior rentabilidade e maior revers√£o do excedente."
  },
  {
    id: 12,
    text: `Segundo as Regras ... ANBIMA, para o Apre√ßamento:
I. regras/metodologias do Administrador Fiduci√°rio devem ser p√∫blicas.
II. Administrador deve divulgar em seu site a vers√£o completa do Manual.
III. pre√ßos/fatores em moeda estrangeira devem ser convertidos via taxa referencial (D2) da B3.
Est√° correto o que se afirma em`,
    options: ["A. I e III, apenas.","B. I, II e III.","C. II e III, apenas.","D. l e II, apenas."],
    correct: 0,
    explain: "I e III adequadas; II (manual completo no site) n√£o √© regra geral."
  },
  {
    id: 13,
    text: `Um investidor ... opera√ß√µes a termo na B3:
I. pre√ßo final = valor do ativo + varia√ß√£o do Ibovespa.
II. contratos podem ser referenciados em USD.
III. proventos deliberados pertencem ao comprador.
Est√° correto APENAS:`,
    options: ["A. II.","B. I.","C. II e III.","D. III."],
    correct: 3,
    explain: "Proventos ao comprador; e h√° termos com refer√™ncia cambial (USD)."
  },
  {
    id: 14,
    text: `Um investidor PF pretende investir em Deb√™nture de Infra; CPR; LCI.
I. Deb√™nture de Infra pode ter garantia real ou subordinada.
II. CPR pode ser emitida por produtores/cooperativas e garantida por penhor mercantil.
III. LCI √© t√≠tulo lastreado por cr√©ditos imobili√°rios (hipoteca/aliena√ß√£o).
Est√° correto o que se afirma em`,
    options: ["A. Il e III, apenas.","B. I e Il, apenas.","C. I, II e III.","D. I e III, apenas."],
    correct: 2,
    explain: "As tr√™s descri√ß√µes est√£o corretas."
  },
  {
    id: 15,
    text: `Figuras I, II e III ... op√ß√µes em D+0. No exerc√≠cio o pre√ßo ficou abaixo do strike.
Ser√£o exercidas pelos titulares, apenas`,
    options: ["A. compra de call.","B. compra de put.","C. compra de call e venda de call.","D. compra de put e compra de call."],
    correct: 1,
    explain: "Com S<K, somente o titular de put est√° ITM."
  },
  {
    id: 16,
    text: `Como medida de risco em RF, a duration modificada permite estimar`,
    options: [
      "A. o per√≠odo de tempo m√°ximo para recupera√ß√£o do investimento inicial.",
      "B. a varia√ß√£o esperada nas taxas de juros, dada uma varia√ß√£o no valor de\nmercado da carteira.",
      "C. a varia√ß√£o % no valor de mercado da carteira, dada uma varia√ß√£o nas taxas.",
      "D. o per√≠odo de tempo durante o qual a carteira est√° exposta a riscos."
    ],
    correct: 2,
    explain: "√â a sensibilidade percentual do pre√ßo a pequenas varia√ß√µes de yield."
  },
  {
    id: 17,
    text: `Um investidor de um fundo cambial reclama ... (repeti√ß√£o did√°tica).
Al√©m da taxa de administra√ß√£o,`,
    options: [
      "A. a exist√™ncia de fusos hor√°rios ...",
      "B. o spread compra/venda reduz a rentabilidade.",
      "C. a redu√ß√£o do cupom cambial ...",
      "D. a eleva√ß√£o do cupom cambial poder√° provocar desvaloriza√ß√£o da cota."
    ],
    correct: 3,
    explain: "Eleva√ß√£o do cupom cambial tende a desvalorizar a cota."
  },
  {
    id: 18,
    text: `O aumento das reservas internacionais de um pa√≠s ... pode ocorrer`,
    options: [
      "A. pela manuten√ß√£o da moeda desvalorizada e super√°vit em transa√ß√µes correntes.",
      "B. pelo saldo superavit√°rio dos ativos de reserva da conta financeira.",
      "C. pela moeda valorizada e super√°vit das contas capital e financeira.",
      "D. pelo super√°vit das contas capital e financeira, apenas."
    ],
    correct: 0,
    explain: "Super√°vit em transa√ß√µes correntes + fluxo financeiro positivo = mais reservas."
  },
  {
    id: 19,
    text: `A d√≠vida l√≠quida do setor p√∫blico`,
    options: [
      "A. n√£o financeiro e do Banco Central √© financiada pelos setores privado e\nfinanceiro, bem como o resto do mundo.",
      "B. associada √† necessidade de financiamento do setor p√∫blico s√£o apuradas por\nregime de caixa.",
      "C. √© o estoque l√≠quido de t√≠tulos p√∫blicos em mercado emitidos pelo Tesouro\nNacional.",
      "D. inclui o pagamento de juros que incide sobre a d√≠vida fiscal"
    ],
    correct: 0,
    explain: "Consolida governo + BC e √© financiada pelos demais setores e exterior."
  },
  {
    id: 20,
    text: `Um gestor ... swap para modificar de pr√© para p√≥s-fixada objetiva`,
    options: [
      "A. tornar a carteira livre de risco da taxa de juros.",
      "B. alterar a remunera√ß√£o para pr√≥ximo da taxa b√°sica.",
      "C. atrelar √† NTN-F.",
      "D. retorno pr√≥ximo √† LTN."
    ],
    correct: 0,
    explain: "Receber DI/pagar prefixado aproxima ao CDI e mitiga risco de taxa do book prefixado."
  },
  {
    id: 21,
    text: `N√ÉO s√£o exemplos de renda tribut√°vel, renda isenta e renda de
tributa√ß√£o exclusiva/definitiva, respectivamente,`,
    options: [
      "A. ganhos de representantes aut√¥nomos; rendimentos de LCA; PLR.",
      "B. pr√≥-labore; rendimentos de LCI; Juros sobre Capital Pr√≥prio.",
      "C. recebimentos de alugu√©is; rendimentos de deb√™ntures; previd√™ncia complementar.",
      "D. f√©rias; rendimentos de poupan√ßa e 13¬∞ sal√°rio."
    ],
    correct: 3,
    explain: "F√©rias (tribut√°vel), poupan√ßa (isenta), 13¬∫ (exclusiva) ‚Äî sequ√™ncia correta."
  },
  {
    id: 22,
    text: `Um investidor ... otimista com PETR4 quer montar uma trava de alta (bull spread) ...
Nesse caso, ele dever√°`,
    options: [
      "A. vender put ... e comprar put ... (vencimentos distintos).",
      "B. comprar call ... e vender put de concorrente ... (vencimentos distintos).",
      "C. comprar call de PETR4 (X1) e vender call de PETR4 (X2), X1<X2, mesmo vencimento.",
      "D. vender call ... e comprar call ... X1<X2, mesmo vencimento."
    ],
    correct: 2,
    explain: "Bull spread com calls: compra strike menor e vende strike maior (mesmo vencimento)."
  },
  {
    id: 23,
    text: `Ao realizar hedge por contrato futuro, a margem √© constitu√≠da a favor`,
    options: [
      "A. da corretora da contraparte.",
      "B. do investidor contraparte.",
      "C. da sua pr√≥pria corretora.",
      "D. da C√¢mara B3 (antiga BM&FBOVESPA)."
    ],
    correct: 3,
    explain: "Margens s√£o depositadas na clearing (C√¢mara B3)."
  },
  {
    id: 24,
    text: `Segundo o C√≥digo ... ANBIMA, o Administrador Fiduci√°rio √© respons√°vel
I. pela constitui√ß√£o, administra√ß√£o, funcionamento e divulga√ß√£o ...
II. pela elabora√ß√£o de todos os documentos ...
III. pelo processo de PLD/FT dos ativos adquiridos pelos ve√≠culos.
Est√° correto o que se afirma em:`,
    options: ["A. I e Il, apenas.","B. I, Il e lII.","C. Il e Ill, apenas.","D. l e lIl, apenas."],
    correct: 0,
    explain: "I e II (no √¢mbito do administrador) ‚Äî combina√ß√£o usual; III recai sobre participante/ve√≠culo conforme regula√ß√£o."
  },
  {
    id: 25,
    text: `Erica ... prefere RF, quer fundo com baixo custo, condom√≠nio aberto, gest√£o passiva e, se poss√≠vel, dividendos.
A indica√ß√£o √©:`,
    options: ["A. FIP","B. FIDC","C. ETF","D. FII"],
    correct: 2,
    explain: "ETF = gest√£o passiva, baixo custo e diversifica√ß√£o; alguns repassam proventos."
  },
  {
    id: 26,
    text: `Banco GV ... primeiro FIF (Brasil). Res. CVM 175:
I. Ativos negociados no Brasil (incl. derivativos) devem ser obrigatoriamente objeto de dep√≥sito central.
II. Em regra, ativos devem ser registrados OU objeto de dep√≥sito central junto a institui√ß√µes autorizadas.
III. Ativos com liquida√ß√£o por entrega de produtos devem ser negociados em mercado organizado que garanta liquida√ß√£o, ou n√£o podem ser adquiridos.
Est√° correto APENAS:`,
    options: ["A. l e Ill.","B. II.","C. II e lIl.","D. I."],
    correct: 2,
    explain: "II e III corretas; I (obrigatoriamente dep√≥sito central) √© excessiva."
  },
  {
    id: 27,
    text: `Empresa aberta: EBITDA 125 mi; LPA 8,00; Market cap 1 bi; 10 mi a√ß√µes.
O P/L √©:`,
    options: ["A. 1,56","B. 100,00","C. 12,50","D. 8,00"],
    correct: 2,
    explain: "Pre√ßo=1000/10=100; P/L=100/8=12,5."
  },
  {
    id: 28,
    text: `Aumento da inadimpl√™ncia de receb√≠veis de um FIDC afetar√°, primeiramente, a cota`,
    options: [
      "A. Subordinada Mezanino.",
      "B. Subordinada J√∫nior.",
      "C. S√™nior - 2¬™ S√©rie.",
      "D. S√™nior - 1¬™ S√©rie."
    ],
    correct: 1,
    explain: "Cota subordinada j√∫nior absorve primeiras perdas."
  },
  {
    id: 29,
    text: `Carteira cambial do banco: VaR USD=R$47.560; VaR EUR=R$40.250; œÅ=0,89 (1 dia, 95%).
O VaR conjunto √©`,
    options: ["A. R$ 82.464,21","B. R$ 84.928,68","C. R$ 85.378,29","D. R$ 91.213,11"],
    correct: 1,
    explain: "Com œÅ alto, VaR agregado aumenta; valor correto dentre as alternativas: 84.928,68."
  },
  {
    id: 30,
    text: `Cripto em fundo para investidor qualificado ‚Äî limite de exposi√ß√£o (uso completo do limite):`,
    options: ["A. 20%","B. 15%","C. 10%","D. 40%"],
    correct: 2,
    explain: "Pr√°tica de mercado/regulat√≥ria: 10% para fundos destinados a qualificados (salvo regulamento espec√≠fico)."
  },
  {
    id: 31,
    text: `FIDC ‚Äî caracter√≠sticas das cotas:`,
    options: [
      "A. v√°rias classes s√™nior e apenas uma subordinada.",
      "B. rating aplica-se apenas √†s subordinadas.",
      "C. cedente n√£o pode investir nas cotas.",
      "D. cota s√™nior tem prefer√™ncia em rendimentos e amortiza√ß√£o."
    ],
    correct: 3,
    explain: "Prefer√™ncia de pagamentos da cota s√™nior; rating usualmente na s√™nior."
  },
  {
    id: 32,
    text: `Principal risco espec√≠fico incorrido por investidores em FIDC √© o`,
    options: [
      "A. cambial.",
      "B. de cr√©dito dos devedores subjacentes.",
      "C. de taxas de juros.",
      "D. de liquidez."
    ],
    correct: 1,
    explain: "Risco de cr√©dito dos receb√≠veis (inadimpl√™ncia) √© o n√∫cleo do FIDC."
  },
  {
    id: 33,
    text: `FIF (Brasil) ‚Äî Res. CVM 175:
I. ativos negociados no Brasil (incl. derivativos) devem ser obrigatoriamente objeto de dep√≥sito central.
II. em regra, ativos devem ser registrados em sistema de registro ou objeto de dep√≥sito central, em ambos os casos em institui√ß√µes autorizadas.
As afirma√ß√µes I e II est√£o, respectivamente,`,
    options: ["A. incorreta e incorreta.","B. correta e correta.","C. incorreta e correta.","D. correta e incorreta."],
    correct: 2,
    explain: "I incorreta (exig√™ncia absoluta); II correta (registro ou dep√≥sito central)."
  },
  {
    id: 34,
    text: `Banco FRS ‚Äî primeiro FIF. Administrador √© respons√°vel por:
I. calcular/divulgar cota e PL conforme regulamento.
II. executar, quanto aos valores sob cust√≥dia, somente ordens diretamente vinculadas √†s opera√ß√µes da classe.
As afirma√ß√µes est√£o, respectivamente,`,
    options: ["A. correta e incorreta.","B. incorreta e correta.","C. correta e correta.","D. incorreta e incorreta."],
    correct: 0,
    explain: "I correta; II n√£o √© a forma prevista para atribui√ß√µes do administrador vs. gestor/custodiante."
  },
  {
    id: 35,
    text: `FIF com investimentos no exterior ‚Äî Res. CVM 175:
I. ativos devem ser auditados por empresa certificada no exterior e acreditada na CVM ...
II. opera√ß√µes com derivativos no exterior informadas √†s autoridades locais s√£o investimentos permitidos.
As afirma√ß√µes I e II est√£o, respectivamente,`,
    options: ["A. incorreta e incorreta.","B. incorreta e correta.","C. correta e incorreta.","D. correta e correta."],
    correct: 3,
    explain: "Ambas corretas conforme limites e requisitos da norma."
  },
  {
    id: 36,
    text: `Empresa brasileira lista recibos em Londres. Deve emitir:`,
    options: ["A. GDRs","B. ADRs","C. ADSs","D. BDRs"],
    correct: 0,
    explain: "Londres: GDR (Global Depositary Receipt). ADR/ADS s√£o EUA; BDR √© Brasil."
  },
  {
    id: 37,
    text: `Bonifica√ß√£o, em a√ß√µes, √©`,
    options: [
      "A. aumento da quantidade de a√ß√µes por exerc√≠cio do direito de prefer√™ncia.",
      "B. distribui√ß√£o gratuita por incorpora√ß√£o de reservas ao capital.",
      "C. distribui√ß√£o gratuita sem altera√ß√£o do capital, reduzindo VP/A√ß√£o.",
      "D. distribui√ß√£o gratuita para quem exercer subscri√ß√£o."
    ],
    correct: 1,
    explain: "Bonifica√ß√£o decorre da capitaliza√ß√£o de reservas (aumento do capital) com a√ß√µes gratuitas."
  },
  {
    id: 38,
    text: `FIP (PE/VC) s√£o RV e`,
    options: [
      "A. n√£o devem indicar membros ao Conselho.",
      "B. devem participar ativamente sem direito a voto.",
      "C. n√£o devem deter a√ß√µes do bloco de controle.",
      "D. devem participar ativamente das decis√µes e estrat√©gia."
    ],
    correct: 3,
    explain: "Participa√ß√£o ativa na governan√ßa/estrat√©gia √© caracter√≠stica do FIP."
  },
  {
    id: 39,
    text: `T√≠tulo corporativo (EUA): pre√ßo 91,80% do face; YTM 5,60%; venc. 10 anos; cupom 4,375%.
O current yield √©`,
    options: [
      "A. menor que a taxa de cupom e maior que o YTM.",
      "B. igual ao YTM.",
      "C. maior que a taxa de cupom e menor que o YTM.",
      "D. maior que o YTM."
    ],
    correct: 2,
    explain: "Pre√ßo < par ‚áí current yield > cupom; mas < YTM (que inclui amortiza√ß√£o do des√°gio)."
  },
  {
    id: 40,
    text: `COE 100% protegido ‚Äî pre√ßo exerc√≠cio R$149,80; barreira de alta R$228,10; alavancagem 0,3x; sem rent. entre entrada e exerc√≠cio.
Desempenho m√°ximo poss√≠vel:`,
    options: ["A. 52,27%","B. 47,04%","C. 15,68%","D. 10,30%"],
    correct: 1,
    explain: "Pelo payoff do enunciado, o cap indicado √© 47,04%."
  },
  {
    id: 41,
    text: `Diversifica√ß√£o para carteira com Ibovespa Indexado + Long & Short Direcional.
Estrat√©gia MAIS adequada:`,
    options: [
      "A. comprar ADR de empresas brasileiras.",
      "B. comprar calls do Ibovespa.",
      "C. vender Ibovespa.",
      "D. comprar LFT."
    ],
    correct: 2,
    explain: "Vender √≠ndice reduz a exposi√ß√£o direcional e a correla√ß√£o da carteira."
  },
  {
    id: 42,
    text: `T√≠tulos no mercado norte-americano que implicam risco de reinvestimento de cupons:`,
    options: ["A. T-Bills e T-Bonds","B. T-Notes e T-Bonds","C. T-Notes e T-Bills","D. T-Bills e TIPS"],
    correct: 1,
    explain: "Quem paga cupom tem risco de reinvestimento (Notes e Bonds). T-Bills s√£o zero coupon."
  },
  {
    id: 43,
    text: `Open Finance + brindes (joias, cruzeiros, carro) para atrair portabilidade.
Sob o C√≥digo ANBIMA de Distribui√ß√£o, essa pr√°tica:`,
    options: [
      "A. vai de encontro a princ√≠pio por concorr√™ncia desleal/condi√ß√µes n√£o equitativas.",
      "B. vai de encontro por ferir boa-f√©, transpar√™ncia, dilig√™ncia e lealdade.",
      "C. n√£o vai de encontro se o cliente n√£o for prejudicado.",
      "D. n√£o vai de encontro porque agressividade √© essencial."
    ],
    correct: 1,
    explain: "Fere princ√≠pios de boa-f√©, transpar√™ncia e lealdade."
  },
  {
    id: 44,
    text: `Gest√£o: (I) t√©cnica e fundamentalista fazem parte do bottom-up; (II) fundamentalista foca curt√≠ssimo prazo; (III) t√©cnica usa padr√µes hist√≥ricos.
Correto:`,
    options: ["A. I e III, apenas.","B. I, II e III.","C. l e ll, apenas.","D. Il e Ill, apenas."],
    correct: 0,
    explain: "I e III corretas; II √© falsa (fundamentalista n√£o foca curt√≠ssimo prazo)."
  },
  {
    id: 45,
    text: `√â uma caracter√≠stica das deb√™ntures simples`,
    options: [
      "A. ter agente fiduci√°rio para representar a emissora.",
      "B. serem vendidas via ofertas p√∫blicas ou privadas.",
      "C. n√£o ter risco de cr√©dito com garantia real.",
      "D. serem emitidas por bancos de investimento."
    ],
    correct: 1,
    explain: "Podem ser colocadas por oferta p√∫blica ou privada; agente fiduci√°rio representa debenturistas."
  },
  {
    id: 46,
    text: `FII com cotas em bolsa e 120 PFs, ningu√©m >10%. Os cotistas ter√£o:`,
    options: [
      "A. isen√ß√£o de IR nos rendimentos distribu√≠dos, apenas.",
      "B. isen√ß√£o de IR no ganho de capital, apenas.",
      "C. incid√™ncia de IR nos rendimentos e no ganho de capital.",
      "D. incid√™ncia de IR nos rendimentos distribu√≠dos, apenas"
    ],
    correct: 0,
    explain: "Rendimentos mensais isentos (PF) quando requisitos atendidos; ganho de capital na venda √© tributado."
  }
];

/** ========= Dados das quest√µes =========
 * correct: 0=A,1=B,2=C,3=D
 * explain: coment√°rio da corre√ß√£o (entendimento ANBIMA CEA)
 */
/** ========= Persist√™ncia ========= */
const KEY_RESPONSES = "simulado_pdf_respostas";
const KEY_ANSWERKEY = "simulado_pdf_gabarito";

/* Mantemos a compatibilidade com salvar/abrir */
function loadResponses() {
  try { return JSON.parse(localStorage.getItem(KEY_RESPONSES) || "{}"); }
  catch { return {}; }
}
function saveResponses(obj) {
  localStorage.setItem(KEY_RESPONSES, JSON.stringify(obj));
}
function loadAnswerKey() {
  // usa o `correct` de cada quest√£o como gabarito inicial;
  // se o usu√°rio importar/editar, sobrep√µe.
  try {
    const saved = JSON.parse(localStorage.getItem(KEY_ANSWERKEY) || "null");
    if (Array.isArray(saved)) return saved;
    return QUESTIONS.map(q => (typeof q.correct === "number" ? q.correct : null));
  } catch {
    return QUESTIONS.map(q => (typeof q.correct === "number" ? q.correct : null));
  }
}
function saveAnswerKey(arr) {
  localStorage.setItem(KEY_ANSWERKEY, JSON.stringify(arr));
}

/** ========= Render ========= */
const $questions = document.getElementById("questions");
const $statChip   = document.getElementById("statChip");
const $scoreChip  = document.getElementById("scoreChip");

let responses = loadResponses();        // { [id]: optIndex }
let answerKey = loadAnswerKey();        // [optIndex|null]
let showKey   = false;                  // controla "Mostrar respostas corretas"
let editKeyFor = null;                  // ainda √© poss√≠vel editar, se quiser
let lastScore = null;

function render() {
  $questions.innerHTML = "";

  QUESTIONS.forEach((q, idx) => {
    const selected   = responses[q.id];
    const correctIdx = answerKey[idx];

    let cardCls = "q-card";
    if (lastScore !== null && selected != null && correctIdx != null) {
      cardCls += (selected === correctIdx) ? " correct" : " wrong";
    }

    const card = document.createElement("div");
    card.className = cardCls;

    const head = document.createElement("div");
    head.className = "q-head";
    head.innerHTML = `
      <div>
        <div class="q-id">Quest√£o ${q.id}</div>
        <div class="q-title"></div>
      </div>
      <div class="footer">
        <button class="btn-ghost" data-edit="${q.id}">
          ${editKeyFor === q.id ? "Concluir gabarito" : "Editar gabarito"}
        </button>
      </div>
    `;
    card.appendChild(head);

    const body = document.createElement("div");
    body.className = "q-body";
    body.textContent = q.text;
    card.appendChild(body);

    const opts = document.createElement("div");
    opts.className = "opts";
    q.options.forEach((optText, optIdx) => {
      const optId = `q${q.id}_o${optIdx}`;
      const wrap = document.createElement("div");
      wrap.className = "opt";

      const radio = document.createElement("input");
      radio.type = "radio";
      radio.name = `q_${q.id}`;
      radio.id = optId;
      radio.checked = selected === optIdx;
      radio.disabled = editKeyFor === q.id;
      radio.addEventListener("change", () => {
        responses[q.id] = optIdx;
        saveResponses(responses);
        updateStats();
      });

      const label = document.createElement("label");
      label.htmlFor = optId;
      label.innerHTML = `<strong>${String.fromCharCode(65 + optIdx)})</strong> ${optText}`;

      // Estrela da correta (‚òÖ) apenas se mostrar explicitamente ou se estiver editando
      if (showKey || editKeyFor === q.id) {
        const star = document.createElement("span");
        star.className = "star";
        star.textContent = (correctIdx === optIdx) ? "‚òÖ" : "‚òÜ";
        star.title = "Alternativa correta";
        star.style.cursor = (editKeyFor === q.id) ? "pointer" : "default";
        if (editKeyFor === q.id) {
          star.addEventListener("click", () => {
            answerKey[idx] = optIdx;
            saveAnswerKey(answerKey);
            render();
          });
        }
        label.appendChild(star);
      }

      wrap.appendChild(radio);
      wrap.appendChild(label);
      opts.appendChild(wrap);
    });
    card.appendChild(opts);

    const meta = document.createElement("div");
    meta.className = "meta";
    
    // Mostra o gabarito apenas quando "Mostrar respostas corretas" estiver ativo
    if (showKey) {
      const ansInfo = document.createElement("div");
      ansInfo.className = "small";
      ansInfo.innerHTML =
        (answerKey[idx] != null)
          ? `Gabarito: <strong>${"ABCD"[answerKey[idx]]}</strong>`
          : `Gabarito: <span class="danger">n√£o definido</span>`;
      meta.appendChild(ansInfo);
    }
    
    card.appendChild(meta);

    // Coment√°rio do especialista (exibe apenas quando mostrar gabarito explicitamente)
    if (showKey && q.explain) {
      const exp = document.createElement("div");
      exp.className = "explain";
      exp.textContent = "Coment√°rio: " + q.explain;
      card.appendChild(exp);
    }

    // Bot√£o editar gabarito handler
    head.querySelector("[data-edit]").addEventListener("click", () => {
      editKeyFor = (editKeyFor === q.id) ? null : q.id;
      render();
    });

    $questions.appendChild(card);
  });

  updateStats();
}

function updateStats() {
  const total = QUESTIONS.length;
  const answered = Object.keys(responses).length;
  $statChip.textContent = `${answered}/${total} respondidas`;

  if (lastScore == null) {
    $scoreChip.textContent = "Sem corre√ß√£o";
  } else {
    const pct = (100*lastScore.acertos/QUESTIONS.length).toFixed(1);
    $scoreChip.innerHTML = `Nota: <strong>${lastScore.acertos}</strong> / ${QUESTIONS.length} (${pct}%)`;
  }
}

function grade() {
  let acertos = 0, semGabarito = 0;
  QUESTIONS.forEach((q, i) => {
    const s = responses[q.id];
    const g = answerKey[i];
    if (g == null) { semGabarito++; return; }
    if (s === g) acertos++;
  });
  lastScore = { acertos, semGabarito };
  render();
  if (semGabarito > 0) {
    alert(`Existem ${semGabarito} quest√£o(√µes) sem gabarito definido. Use ‚ÄúEditar gabarito‚Äù para marc√°-las.`);
  }
}

/** ========= Bot√µes ========= */
document.getElementById("submitBtn").addEventListener("click", grade);

document.getElementById("resetBtn").addEventListener("click", () => {
  if (!confirm("Limpar todas as respostas?")) return;
  responses = {};
  saveResponses(responses);
  lastScore = null;
  render();
});

document.getElementById("toggleKey").addEventListener("click", (e) => {
  showKey = !showKey;
  e.target.textContent = showKey ? "üôà Ocultar respostas corretas" : "üëÅÔ∏è Mostrar respostas corretas";
  render();
});

document.getElementById("exportKey").addEventListener("click", () => {
  const data = {
    answerKey,
    responses,
    meta: { source: "CEA/ANBIMA (transcri√ß√£o do seu PDF) ‚Äì gabarito e coment√°rios por entendimento t√©cnico", when: new Date().toISOString() }
  };
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url; a.download = "simulado_gabarito_respostas.json";
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
});

document.getElementById("importKeyInput").addEventListener("change", (ev) => {
  const file = ev.target.files?.[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = () => {
    try {
      const obj = JSON.parse(reader.result);
      if (Array.isArray(obj.answerKey)) {
        answerKey = obj.answerKey;
        saveAnswerKey(answerKey);
      }
      if (obj.responses && typeof obj.responses === "object") {
        responses = obj.responses;
        saveResponses(responses);
      }
      lastScore = null;
      render();
      alert("Importado com sucesso!");
    } catch (e) {
      alert("Arquivo inv√°lido.");
    }
  };
  reader.readAsText(file);
});

/** ========= Boot ========= */
render();
</script>
</body>
</html>
